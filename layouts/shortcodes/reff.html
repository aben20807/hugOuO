{{- $path := .Get 0 -}}
{{ $page := .Page }}
{{ if (not (hasPrefix $path "#")) }}
{{- $filepath := printf "%s%s" ($path | replaceRE `#.*?$` `` | replaceRE `/*$` ``) ".md" -}}
{{- $page = .Site.GetPage $filepath -}}
{{ end }}
{{- $headingAnchor := (replace (index (findRE  `#(.*?)$` $path) 0) "/" "") -}} 
<a href="{{ relref . $path }}">{{ with $page }}{{ .Title }}{{ $headingAnchor }}{{ end }}</a>
