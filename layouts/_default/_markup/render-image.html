{{/* https://gohugo.io/templates/render-hooks/ */}}
{{/* Ref: https://sebastiandedeyne.com/captioned-images-with-markdown-render-hooks-in-hugo/ */}}
{{- $gdrive_text := `google-(.*)` -}}
{{- $new_gdrive_text := `${1}` -}}
{{- $custom_width := (.Title | replaceRE `.*=(\d*)x.*` `${1}`) -}}
{{- $text := .Text | plainify | htmlUnescape | replaceRE $gdrive_text $new_gdrive_text -}}
<figure class="gphoto-media center">
    <div class="img-container center">
        <noscript>
            <img src="{{ .Destination | safeURL }}" oncontextmenu="return false;" class="center img-zoomable" alt='{{ $text }}' data-action="zoom"
                title='{{ $text }}'>
        </noscript>
        <img data-src="{{ .Destination | safeURL }}" oncontextmenu="return false;" class="center img-zoomable lazyload" alt='{{ $text }}'
            {{ with $custom_width }} width="{{ . }}"{{ end }} data-action="zoom" title='{{ $text }}'>
    </div>
    <figcaption>
        <center class="caption-text" style="margin: 0 .3rem 0;">
            {{ if .Text }}
            <p style="margin: .5rem 0 0;">{{ .Text | replaceRE $gdrive_text $new_gdrive_text | safeHTML }}</p>
            {{ end }}
            <!-- hide the link -->
            <font class="douyin hover-show">
                <a href="{{ .Destination | safeURL }}" target="_blank" rel="noreferrer noopener"
                    style="opacity: 1.0; text-decoration: none;">OuO</a>
            </font>
        </center>
    </figcaption>
</figure>